<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>AutoWFLib Project | Automated Web Font Library</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="canonical" href="https://autowflib.pages.dev/">
    <link rel="shortcut icon" href="./favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="./favicon.png" type="image/png">

    <meta property="og:type" content="website">
    <meta property="og:title" content="AutoWFLib">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@neruthes">
    <meta name="twitter:creator" content="@neruthes">
    <meta name="twitter:title" content="AutoWFLib Project">
    <meta name="twitter:description" content="AutoWFLib Project | Automated Web Font Library">
    <meta name="twitter:image" content="./favicon.png">

    <link rel="stylesheet" href="https://autowflibcdn.pages.dev/awfl-cdn/css/brygada-1918.css">
    <link rel="stylesheet" href="https://autowflibcdn.pages.dev/awfl-cdn/css/c059.css">
    <link rel="stylesheet" href="https://autowflibcdn.pages.dev/awfl-cdn/css/nacelle.css">

    <style>
        @import url('./full.css');

        * {
            text-rendering: optimizeLegibility;
            box-sizing: border-box;
            hyphens: none;
            font-variant-ligatures: none;
        }

        html,
        body {
            /* font-family: -apple-system, 'SF Pro Text', BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; */
            /* font-family: 'Brygada 1918', serif; */
            font-size: 5mm;
            padding: 0rem;
            margin: 0rem;
        }

        a {
            color: #03C;
            text-decoration: none;
        }

        .grand-container {}

        .big-part {
            max-width: 42rem;
            padding: 2rem;
            margin: 2rem auto;
        }

        h1 {
            font-weight: 400;
            font-variant-caps: small-caps;
        }

        .big-part footer {
            font-size: 0.65rem;
            text-align: center;
            opacity: 0.7;
        }

    </style>
    <style>
        /* Utilities */
        .inline-block {
            display: inline-block;
        }

        .serif {
            font-family: 'Brygada 1918', serif;
        }

        .sans {
            font-family: 'Nacelle', sans-serif;
        }

    </style>
</head>

<body>
    <div class="grand-container serif">

        <div class="big-part" style="min-height: 700px;">
            <header>
                <h1>AutoWFLib</h1>
                <p style="font-size: 0.85rem;">
                    Automated Web Font Library.
                    Collaborative park for open-source fonts.
                    An addition to mainstream web font hosting services.
                </p>
            </header>
            <div class="top-nav">
            </div>

            <style>
                .fontslist-area-list {
                    font-family: 'Nacelle', sans-serif;
                    font-size: 0rem;
                }

                @media screen and (min-width: 800px) {
                    .fontslist-item-fontInfoCard {
                        float: left;
                        width: 50%;
                    }

                    .fontslist-item-fontInfoCard[data-shown="true"][data-evenodd="0"] {
                        padding-left: 0.6rem;
                    }

                    .fontslist-item-fontInfoCard[data-shown="true"][data-evenodd="1"] {
                        padding-right: 0.6rem;
                    }
                }

                .fontslist-item-fontInfoCard[data-shown="false"] {
                    display: none;
                }

                .fontInfoCard--inner {
                    font-weight: 400;
                    font-variant: normal;
                    font-size: 1rem;
                    border: 1px solid #AAA;
                    border-radius: 0.4rem;
                    margin: 0 0 1.2rem;
                    padding: 1rem 1rem;
                    transition: all 120ms ease;
                }

                .fontInfoCard--inner:hover {
                    transform: scale(1.015) translateY(-0.2rem);
                    box-shadow: rgba(0, 0, 0, 0.09) 0 0.8rem 2.75rem 0.2rem;
                }

                .fontInfoCard--toparea {
                    height: 0.9rem;
                }

                .fontInfoCard--midarea {
                    font-size: 0.7rem;
                    padding: 0.6rem 0;
                    opacity: 0.6;
                }

                .fontInfoCard--subarea {
                    font-size: 0.7rem;
                }

                .fontInfoCard--family {
                    font-size: 0.8rem;
                    color: rgba(0, 0, 0, 0);
                }

                .fontInfoCard--variants {
                    float: right;
                }

            </style>
            <div class="search-area sans" style="margin: 1.2rem 0;">
                <input id="js-mainSearchBox" type="text" placeholder="Search font by name" style="
                    font-size: 0.8rem;
                    border: 1px solid #AAA;
                    border-radius: 0.4rem;
                    display: block;
                    width: 100%;
                    padding: 0.5rem;
                ">
            </div>
            <div class="filters-area sans" style="font-size: 0.8rem; margin: 1.2rem 0;">
                <div class="filter-group inline-block">
                    <label for="js-listFilter-category">Category:</label>
                    <select name="js-listFilter-category" id="js-listFilter-category">
                        <option value="ALL">All Categories</option>
                    </select>
                </div>
            </div>
            <!-- <div style="background: #AAA; height: 1px; margin: 2rem 0;"></div> -->
            <div class="fontslist-area" style="margin: 1.2rem 0;">
                <div class="fontslist-area-list"></div>
                <div class="fontslist-area-list-appendix serif"></div>
            </div>
        </div>

        <div class="big-part">
            <footer>
                <p>
                    Copyright &copy; 2023 Neruthes, and other contributors.
                </p>
                <p>
                    The collected fonts may be copyrighted by their respective creators.<br>
                    See GitHub repository README for more info on copyright and license.
                </p>
                <p>
                    Mirrors of this site:<br>
                    <a style="display: inline-block;" href="https://autowflib.pages.dev/">Main</a> /
                    <a style="display: inline-block;" href="https://neruthes.github.io/autowflib/">GitHub Pages</a> /
                    <a style="display: inline-block;" href="https://autowflib.neruthes.xyz/">Other</a>
                </p>
                <p>
                    Other links:<br>
                    <a style="display: inline-block;" href="https://github.com/neruthes/autowflib">GitHub</a>
                </p>
            </footer>
        </div>

    </div>

    <script>
        (function () {
            const app = {
                ram: {
                    categoriesList: [],
                    fontIdList: [],
                    fontDataMap: {},
                    filterData: {
                        category: 'ALL'
                    }
                }
            };
            window.app_3639cc171fa746bdbf162d44666c3fa8 = app;



            // App functions
            app.renderFontsListDom = function () {
                const listDiv = document.querySelector('.fontslist-area-list');
                listDiv.innerHTML = app.ram.fontIdList.map(function (fontid, itr) {
                    const data = app.ram.fontDataMap[fontid];
                    return `<div class="fontslist-item-fontInfoCard"
                        data-evenodd="${(itr + 1) % 2}"
                        data-shown="true" data-search-term=" ${data.id} ${data.family.toLowerCase()} "
                        data-font-id="${data.id}" data-font-family="${data.family}"
                        data-font-category="${data.category}" data-variants-count=${data.list.length}
                    >
                        <div class="fontInfoCard--inner">
                            <div style="${({
                            fonts: `background: url('./fontname-thumbnail/${data.id[0]}/${data.id}.png') left center no-repeat scroll; background-size: auto 80%;`,
                            relay: ''
                        })[data.minikv.type]}"
                                class="fontInfoCard--toparea"
                            >
                                <span class="fontInfoCard--family" style="${data.minikv.type === 'relay' ? `color: inherit; font-family: ${data.family};` : ''}">${data.family}</span>
                            </div>
                            <div class="fontInfoCard--midarea">
                                <div class="fontInfoCard--variants">${data.minikv.vars || data.list.length} variants</div>
                                <div class="fontInfoCard--category">${data.category}</div>
                                <div style="clear: both;"></div>
                            </div>
                            <div class="fontInfoCard--subarea">
                                <a target="_blank" href="https://autowflibcdn.pages.dev/awfl-cdn/css/${data.id}.css">CSS Link</a>
                                &nbsp;&nbsp;&nbsp;
                                <a target="_blank" href="./preview/?id=${data.id}&family=${encodeURIComponent(data.family)}">Preview</a>
                                &nbsp;&nbsp;&nbsp;
                                <a target="_blank" href="https://github.com/neruthes/autowflib/blob/master/fonts/${data.category}/${data.id}/info">Definition</a>
                                ${data.minikv.type === 'relay' ? '&nbsp;&nbsp;&nbsp;<span style="opacity: 0.5;">(Relayed)</span>' : ''}
                            </div>
                        </div>
                    </div>`;
                }).join('') + '<div style="float: left; width: 50%; height: 1px;"></div>' + '<div style="clear: both;"></div>';
            };
            app.searchBoxInputEventHandler = function (e) {
                const box = e.target;
                app.ram.listingCriteriaDirty = true;
            };
            app.updateSearchResultList = function (forceRun) {
                const box = document.querySelector('#js-mainSearchBox');
                const requestSearchTerm = box.value.trim().toLowerCase();
                if (!forceRun && app.ram.listingCriteriaDirty === false) {
                    return 0;
                };
                app.ram.listingCriteriaDirty = false;
                let evenodd = 0;
                if (requestSearchTerm.trim().length === 0) {
                    // Reset list view to show all (within the category!)
                    document.querySelectorAll('.fontslist-item-fontInfoCard').forEach(function (card) {
                        let shown = false;
                        if (app.ram.filterData.category === 'ALL' || card.dataset.fontCategory.startsWith(app.ram.filterData.category)) {
                            shown = true;
                            evenodd = (evenodd + 1) % 2;
                        };
                        card.dataset.shown = shown;
                        card.dataset.evenodd = evenodd;
                    });
                    return 0;
                } else {
                    app.ram.fontIdList.forEach(function (id) {
                        if (!app.ram.fontDataMap[id].category.startsWith(app.ram.filterData.category) && app.ram.filterData.category !== 'ALL') {
                            document.querySelector(`.fontslist-item-fontInfoCard[data-font-id=${id}]`).dataset.shown = false;
                            document.querySelector(`.fontslist-item-fontInfoCard[data-font-id=${id}]`).dataset.evenodd = evenodd;
                            return 0;
                        };
                        if (app.ram.fontDataMap[id].searchTerm.indexOf(requestSearchTerm) >= 0) {
                            evenodd = (evenodd + 1) % 2;
                            document.querySelector(`.fontslist-item-fontInfoCard[data-font-id=${id}]`).dataset.shown = true;
                        } else {
                            document.querySelector(`.fontslist-item-fontInfoCard[data-font-id=${id}]`).dataset.shown = false;
                        };
                        document.querySelector(`.fontslist-item-fontInfoCard[data-font-id=${id}]`).dataset.evenodd = evenodd;
                    });
                };
                if (document.querySelector('.fontslist-area-list').offsetHeight < 10) {
                    document.querySelector('.fontslist-area-list-appendix').innerHTML = `No match found :(`;
                } else {
                    document.querySelector('.fontslist-area-list-appendix').innerHTML = ``;
                }
            };
            document.querySelector('#js-mainSearchBox').value = '';
            document.querySelector('#js-mainSearchBox').addEventListener('input', app.searchBoxInputEventHandler);
            window.setInterval(app.updateSearchResultList, 100);



            // Load data
            const xhr = new XMLHttpRequest();
            xhr.open('GET', './font-family-datamap.txt');
            xhr.onload = function () {
                // Initialize database
                let arr = xhr.responseText.trim().split('\n');
                let categoriesSet = new Set();
                arr.forEach(function (dataline) {
                    console.log(dataline);
                    if (dataline.startsWith('@family|')) {
                        const [id, family, category, minikvRaw] = dataline.split('|').slice(1);
                        app.ram._currentParsingId = id;
                        app.ram.fontIdList.push(id);
                        categoriesSet.add(category);

                        const minikv = {};
                        minikvRaw.split('&').forEach(function (kv) {
                            const [k, v] = kv.split('=');
                            minikv[k] = v;
                        });

                        app.ram.fontDataMap[id] = {
                            id, family, category, minikv,
                            searchTerm: `${category} ${id} ${family.toLowerCase()}`
                        };
                    };
                    if (dataline.startsWith('@list|')) {
                        const list = dataline.split('|').slice(1);
                        app.ram.fontDataMap[app.ram._currentParsingId].list = list;
                    };
                });
                let categoriesList_tmp = ['114514'];
                categoriesSet.forEach(x => categoriesList_tmp.push(x));
                app.ram.categoriesList = categoriesList_tmp.sort();
                console.log(app.ram);

                // Initialize UI: Query filters
                document.querySelector('#js-listFilter-category').innerHTML += app.ram.categoriesList.map(function (catname, itr, arr) {
                    if (catname === '114514') {
                        return '';
                    };
                    const lastPrefix = arr[itr - 1].split('-')[0];
                    const currentPrefix = catname.split('-')[0];
                    if (lastPrefix !== currentPrefix) {
                        console.log('-----------------------------------');
                        console.log(`catname=${catname}          ${lastPrefix} -> ${currentPrefix}`);
                        return `<option disabled value="groupsepline-${catname}">--------------------</option>
                        <option value="${currentPrefix}-">(All ${currentPrefix[0].toUpperCase() + currentPrefix.slice(1)})</option>
                        <option value="${catname}">${catname}</option>`;
                    };
                    console.log(`catname=${catname}          ${lastPrefix} -> ${currentPrefix}`);
                    return `<option value="${catname}">${catname}</option>`;
                }).join('');
                document.querySelector('#js-listFilter-category').addEventListener('input', function (e) {
                    app.ram.filterData.category = e.target.value;
                    app.ram.listingCriteriaDirty = true;
                });

                // Initialize UI: Fonts list view
                app.renderFontsListDom();

                // Initialize UI: Miscellaneous stuff
                document.querySelector('#js-mainSearchBox').placeholder = `Search font by name in ${app.ram.fontIdList.length} families`;
            };
            xhr.send();
        })();
    </script>
</body>

</html>
